window.nvpack=window.nvpack||{},window.nvpack.abtest=function(){"use strict";var t=function(){var t={startStopTimes:{},idleTimeoutMs:3e4,currentIdleTimeMs:0,checkStateRateMs:250,active:!1,idle:!1,currentPageName:"default-page-name",timeElapsedCallbacks:[],userLeftCallbacks:[],userReturnCallbacks:[],trackTimeOnElement:function(e){var n=document.getElementById(e);n&&(n.addEventListener("mouseover",function(){t.startTimer(e)}),n.addEventListener("mousemove",function(){t.startTimer(e)}),n.addEventListener("mouseleave",function(){t.stopTimer(e)}),n.addEventListener("keypress",function(){t.startTimer(e)}),n.addEventListener("focus",function(){t.startTimer(e)}))},getTimeOnElementInSeconds:function(e){var n=t.getTimeOnPageInSeconds(e);return n||0},startTimer:function(e){if(e||(e=t.currentPageName),void 0===t.startStopTimes[e])t.startStopTimes[e]=[];else{var n=t.startStopTimes[e],i=n[n.length-1];if(void 0!==i&&void 0===i.stopTime)return}t.startStopTimes[e].push({startTime:new Date,stopTime:void 0}),t.active=!0},stopAllTimers:function(){for(var e=Object.keys(t.startStopTimes),n=0;n<e.length;n++)t.stopTimer(e[n])},stopTimer:function(e){e||(e=t.currentPageName);var n=t.startStopTimes[e];void 0!==n&&0!==n.length&&(void 0===n[n.length-1].stopTime&&(n[n.length-1].stopTime=new Date),t.active=!1)},getTimeOnCurrentPageInSeconds:function(){return t.getTimeOnPageInSeconds(t.currentPageName)},getTimeOnPageInSeconds:function(e){return void 0===t.getTimeOnPageInMilliseconds(e)?void 0:t.getTimeOnPageInMilliseconds(e)/1e3},getTimeOnCurrentPageInMilliseconds:function(){return t.getTimeOnPageInMilliseconds(t.currentPageName)},getTimeOnPageInMilliseconds:function(e){var n=t.startStopTimes[e];if(void 0!==n){for(var i=0,o=0;o<n.length;o++){var a=n[o].startTime,r=n[o].stopTime;void 0===r&&(r=new Date),i+=r-a}return Number(i)}},getTimeOnAllPagesInSeconds:function(){for(var e=[],n=Object.keys(t.startStopTimes),i=0;i<n.length;i++){var o=n[i],a=t.getTimeOnPageInSeconds(o);e.push({pageName:o,timeOnPage:a})}return e},setIdleDurationInSeconds:function(e){var n=parseFloat(e);if(!1!==isNaN(n))throw{name:"InvalidDurationException",message:"An invalid duration time ("+e+") was provided."};return t.idleTimeoutMs=1e3*e,this},setCurrentPageName:function(e){return t.currentPageName=e,this},resetRecordedPageTime:function(e){delete t.startStopTimes[e]},resetAllRecordedPageTimes:function(){for(var e=Object.keys(t.startStopTimes),n=0;n<e.length;n++)t.resetRecordedPageTime(e[n])},resetIdleCountdown:function(){t.idle&&t.triggerUserHasReturned(),t.idle=!1,t.currentIdleTimeMs=0},callWhenUserLeaves:function(t,e){this.userLeftCallbacks.push({callback:t,numberOfTimesToInvoke:e})},callWhenUserReturns:function(t,e){this.userReturnCallbacks.push({callback:t,numberOfTimesToInvoke:e})},triggerUserHasReturned:function(){if(!t.active)for(var e=0;e<this.userReturnCallbacks.length;e++){var n=this.userReturnCallbacks[e],i=n.numberOfTimesToInvoke;(isNaN(i)||void 0===i||i>0)&&(n.numberOfTimesToInvoke-=1,n.callback())}t.startTimer()},triggerUserHasLeftPage:function(){if(t.active)for(var e=0;e<this.userLeftCallbacks.length;e++){var n=this.userLeftCallbacks[e],i=n.numberOfTimesToInvoke;(isNaN(i)||void 0===i||i>0)&&(n.numberOfTimesToInvoke-=1,n.callback())}t.stopAllTimers()},callAfterTimeElapsedInSeconds:function(e,n){t.timeElapsedCallbacks.push({timeInSeconds:e,callback:n,pending:!0})},checkState:function(){for(var e=0;e<t.timeElapsedCallbacks.length;e++)t.timeElapsedCallbacks[e].pending&&t.getTimeOnCurrentPageInSeconds()>t.timeElapsedCallbacks[e].timeInSeconds&&(t.timeElapsedCallbacks[e].callback(),t.timeElapsedCallbacks[e].pending=!1);!1===t.idle&&t.currentIdleTimeMs>t.idleTimeoutMs?(t.idle=!0,t.triggerUserHasLeftPage()):t.currentIdleTimeMs+=t.checkStateRateMs},visibilityChangeEventName:void 0,hiddenPropName:void 0,listenForVisibilityEvents:function(){void 0!==document.hidden?(t.hiddenPropName="hidden",t.visibilityChangeEventName="visibilitychange"):void 0!==document.mozHidden?(t.hiddenPropName="mozHidden",t.visibilityChangeEventName="mozvisibilitychange"):void 0!==document.msHidden?(t.hiddenPropName="msHidden",t.visibilityChangeEventName="msvisibilitychange"):void 0!==document.webkitHidden&&(t.hiddenPropName="webkitHidden",t.visibilityChangeEventName="webkitvisibilitychange"),document.addEventListener(t.visibilityChangeEventName,function(){document[t.hiddenPropName]?t.triggerUserHasLeftPage():t.triggerUserHasReturned()},!1),window.addEventListener("blur",function(){t.triggerUserHasLeftPage()}),window.addEventListener("focus",function(){t.triggerUserHasReturned()}),document.addEventListener("mousemove",function(){t.resetIdleCountdown()}),document.addEventListener("keyup",function(){t.resetIdleCountdown()}),document.addEventListener("touchstart",function(){t.resetIdleCountdown()}),window.addEventListener("scroll",function(){t.resetIdleCountdown()}),setInterval(function(){t.checkState()},t.checkStateRateMs)},websocket:void 0,websocketHost:void 0,setUpWebsocket:function(e){if(window.WebSocket&&e){var n=e.websocketHost;try{t.websocket=new WebSocket(n),window.onbeforeunload=function(n){t.sendCurrentTime(e.appId)},t.websocket.onopen=function(){t.sendInitWsRequest(e.appId)},t.websocket.onerror=function(t){console&&console.log("Error occurred in websocket connection: "+t)},t.websocket.onmessage=function(t){console&&console.log(t.data)}}catch(t){console&&console.error("Failed to connect to websocket host.  Error:"+t)}}return this},websocketSend:function(e){t.websocket.send(JSON.stringify(e))},sendCurrentTime:function(e){var n={type:"INSERT_TIME",appId:e,timeOnPageMs:t.getTimeOnCurrentPageInMilliseconds(),pageName:t.currentPageName};t.websocketSend(n)},sendInitWsRequest:function(e){var n={type:"INIT",appId:e};t.websocketSend(n)},initialize:function(e){var n=t.idleTimeoutMs||30,i=t.currentPageName||"default-page-name",o=void 0;e&&(n=e.idleTimeoutInSeconds||n,i=e.currentPageName||i,o=e.websocketOptions),t.setIdleDurationInSeconds(n).setCurrentPageName(i).setUpWebsocket(o).listenForVisibilityEvents(),t.startTimer()}};return t}();class e{constructor(){this.document=window.document}set(t,e,n,i){var o=new Date((new Date).setHours(23,59,59,0));n=n||0==n?"expires="+n:"expires="+o,i=i?"domain=."+i:"",document.cookie=t+"="+e+"; "+n+"; "+i+"; path=/; secure"}get(t){for(var e=t+"=",n=document.cookie.split(";"),i=0;i<n.length;i++){var o=n[i].trim();if(0==o.indexOf(e))return o.substring(e.length,o.length)}return null}remove(t){document.cookie=t+"=; Max-Age=-99999999;"}lsSupport(){return!!window.localStorage}setLS(t,e){return this.lsSupport()&&localStorage.setItem(t,e)}getLS(t){return this.lsSupport()?localStorage.getItem(t):null}duration(t){var e=1,n="Fri, 31 Dec 1999 23:59:59 GMT";if(t)if(501==t)n="Fri, 31 Dec 1999 23:59:59 GMT";else if(0==t)n=0;else{500==t?e=365:t>0&&t<=90&&(e=t);var i=new Date;1!=e&&(e-=1,i.setTime(i.getTime()+24*e*60*60*1e3)),i.setHours(23,59,59,0),n=i}return n}}var n="https://heatmaps.notifyvisitors.com/",i="https://heatcron1.notifyvisitors.com/",o="notify_visitors",a={urls:{heatmapSettings:n+"brand/t1/hs",heatmapData:n+"brand/t2/heatmapData",heatmapData_new:n+"brand/t2_new/heatmapData",heatmapUrl:n,heatcronUrl:i,socketPath:"/socket/socket.io",contentUrl:n+"endapi/content/data",contentUrlHeat:i+"endapi/content/data",hmContentUrl:n+"endapi/hmContent/data",awsWebSocketUrl:"wss://wsshm.notifyvisitors.com",abtestData:n+"brand/t2/abtestData"},js_urls:{hm:n+"js/heatmap/hm_paint.js",ab:"https://optimiser.notifyvisitors.com/js/abTest/bootEditor.js",socket:"https://cdn.notifyvisitors.com/ext/external/socket.js"}},r=(window[o].Optimize.data,(t,e,n)=>{if(e||(e=window.location.href),t=t.replace(/[\[\]]/g,"\\$&"),n)t=t.toLowerCase(),e=e.toLowerCase();var i=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)").exec(e);return i?i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):"":null}),s=(t,e)=>{if(!t)throw new Error('this function need "query" to work');if("string"==typeof t)return r(t,e);if("object"==typeof t){var n=!0;return Object.keys(t).forEach(function(i){i&&"string"==typeof i&&(n=r(i,e)===t[i])}),n}},c=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e="AB_TEST";switch(t){case"0":e="AB_TEST";break;case"1":e="SPLIT_TEST";break;case"3":e="PERSONALIZATION"}return e},d=t=>{"string"==typeof t&&(t=JSON.parse(t));var e,n=t.nodeType;switch(n){case 1:e=document.createElement(t.tagName);for(var i=t.attributes||[],o=0,a=i.length;o<a;o++){var r=i[o];e.setAttribute(r[0],r[1])}break;case 3:e=document.createTextNode(t.nodeValue);break;case 8:e=document.createComment(t.nodeValue);break;case 9:e=document.implementation.createDocument();break;case 10:e=document.implementation.createDocumentType(t.nodeName);break;case 11:e=document.createDocumentFragment();break;default:return e}if(1==n||11==n){var s=t.childNodes||[];for(o=0,a=s.length;o<a;o++)e.appendChild(d(s[o]))}return e},u=t=>{for(var e=0;e<t.length;e++)t[e].setAttribute("ab-key",e)},f=(t,e)=>{for(var n=0,i=0;i<e.length;i++){var o=e[i].getAttribute("ab-key");parseInt(t)===parseInt(o)&&(n=i)}return e[n]},v=t=>{var e=t,n=e.children;null!=n[0].getAttribute("ab-key")&&void 0!==n[0].getAttribute("ab-key")||u(n);for(var i=0;i<n.length;i++)e.insertBefore(f(parseInt(i),n),n[i]);n.length&&e.insertBefore(f(0,n),n[0])},l=(t,e)=>{var n=t,i=n.children;u(i);for(var o=e,a=0;a<o.length;a++)void 0===o[a]||n.insertBefore(f(parseInt(o[a]),i),i[a])},h=(t,e)=>{if(t!=e){var n=null,i=(e=(e.match(/\S+/g)||[]).join(" ")).split(" ").splice(0,e.split(" ").length-2).join(" "),o=document.querySelector(i);if(2==e.split(":").length?e.split(":")[1].split(" ").length>2||(n=e.split(":")[1].split("(")[1].split(")")[0]):e.split(":")[e.split(":").length-1]&&1!=e.split(":").length&&(n=e.split(":")[e.split(":").length-1].split("(")[1].split(")")[0]),null==n)o.appendChild(document.querySelector(t));else{var a={},r=!1,s=(t.match(/\S+/g)||[]).join(">");try{a=document.querySelector(s)}catch(t){r=!0}r&&(a=document.querySelector(t)),o.insertBefore(a,o.children[n-1])}}},w=t=>{for(var e="",n=window.location.href.split("?"),i=n[n.length-1].split("&"),o=0;o<i.length;o++)-1!=i[o].indexOf(t)&&(e=i[o].split("=")[1]);var a=[];for(o=0;o<i.length;o++)-1==i[o].indexOf(t)&&a.push(i[o]);return""!=a.join("&")?n[n.length-1]=a.join("&"):n.pop(),n=n.join("?"),window.history.replaceState(null,null,n),e},m=t=>{var e,n,i,o;return o=t%1e3,i=Math.floor(t/1e3),n=Math.floor(i/60),i%=60,e=Math.floor(n/60),n%=60,{d:Math.floor(e/24),h:e%=24,m:n,s:i,ms:o}},g=t=>864e5*t.d+36e5*t.h+6e4*t.m+1e3*t.s+t.ms,b=t=>{var e=document.getElementById(t||"_nv_hm_hidden_element");null!=e&&(window[o].Optimize.data&&window[o].Optimize.data.details&&window[o].Optimize.data.details.isIE?e.parentNode.removeChild(e):e.remove())},p=t=>{var e={abTest:!1,split:!1,abTestGoals:!1};if(t.hasOwnProperty("abTest")&&t.abTest&&"object"==typeof t.abTest)for(var n=0;n<Object.keys(t.abTest).length;n++){var i=t.abTest[n];if("object"==typeof i)if(i.hasOwnProperty("visitorData")&&i.visitorData&&"object"==typeof i.visitorData&&(window[o].Optimize.data.abTest[n].visitorData=i.visitorData),i.campDetail&&"1"==i.campDetail.type){if(e.split=!0,t.abTest.split=n,!i.campDetail.variationIDs.includes("1")){e.abTest=!1;break}}else e.abTest=!0}return t.hasOwnProperty("abTestGoals")&&t.abTestGoals&&"object"==typeof t.abTestGoals&&(e.abTestGoals=!0),e},_=(t,e,n)=>{var i=window.getComputedStyle(t).getPropertyValue(e);return(i="string"==typeof i?i:"").replace(/ /g,"")!==n.replace(/ /g,"")&&(t.style.removeProperty?t.style.removeProperty(e):t.style.removeAttribute(e),t.getAttribute("style")+"".concat(e,":").concat(n," !important; "))},y=(t,e)=>{var n=null,i=t.substring(0,t.indexOf(">")),o="div";switch(i=i.includes(" ")?t.substring(0,t.indexOf(" ")):i){case"<td":case"<th":o="tr";break;case"<tr":o="tbody";break;case"<tbody":o="table";break;default:o="div"}var a=document.createElement(o);return a.classList.add("myClass"),a.innerHTML=t.trim(),e&&(n=a),n||a.firstChild};function O(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function T(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,i)}return n}var S,I,j,k,N=()=>{var t,e,n=window.document,i=0;return{get:function(o,a,r,s){var c=-1!==o.indexOf("?")?"&":"?";a=a||{};var d=A();for(e in d&&Array.isArray(d)&&d.length>0&&(a.cookieData=d.join(";")),notify_visitors&&notify_visitors.cookie_domain&&(a.cookieDomain=notify_visitors.cookie_domain),a)a.hasOwnProperty(e)&&(c+=encodeURIComponent(e)+"="+encodeURIComponent(a[e])+"&");var u=r+ ++i;return window[u]=function(t){s(t);try{delete window[u]}catch(t){}window[u]=null},function(e){var i=n.createElement("script"),o=!1;i.src=e,i.async=!0,i.onload=i.onreadystatechange=function(){o||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(o=!0,i.onload=i.onreadystatechange=null,i&&i.parentNode&&i.parentNode.removeChild(i))},!t&&(t=n.getElementsByTagName("head")[0]),t.appendChild(i)}(o+c+"js_callback="+u),u},post:function(t,e,n,i,o){o.ajax({url:t,type:"POST",data:e,contentType:!1,processData:!1,success:i})}}},D=()=>{var t,e=!0,n={},i=!1;function o(t){i=!0,clearInterval(t),e&&setTimeout(function(){a("selfCall")},10)}function a(t,i,o,r,s){t&&(void 0===s&&(s=!0),e&&("function"==typeof gtag?"selfCall"===t?Object.keys(n).forEach(function(t){if(t&&n[t]&&n[t].length>0){for(var e=0;e<n[t].length;e++)gtag("event",t,{nv_campaign:n[t][e][3],nv_uid:window.notify_visitors.data.NV_UID});n[t]=[]}}):gtag("event",o,{nv_campaign:r,nv_uid:window.notify_visitors.data.NV_UID}):"function"==typeof ga?"selfCall"===t?Object.keys(n).forEach(function(t){if(t&&n[t]&&n[t].length>0){for(var e=0;e<n[t].length;e++)ga(t+".send","event",n[t][e][1],n[t][e][2],n[t][e][3],1,{nonInteraction:n[t][e][4]});n[t]=[]}}):ga(t+".send","event",i,o,r,1,{nonInteraction:s}):"selfCall"!==t?(n[t]||(n[t]=[]),n[t].push([t,i,o,r,s])):setTimeout(function(){a("selfCall")},100)))}return{send:a,create:function a(r,s){if(r)if("undefined"!=typeof ga&&ga.loaded&&"function"==typeof ga)try{if(s)ga("create",s,"auto",{name:r});else if(ga.getAll&&Array.isArray(ga.getAll())&&ga.getAll().length>0){var c=ga.getAll()[0].get("trackingId"),d=ga.getByName(r);c&&!d&&(ga("create",c,"auto",{name:r}),o(t))}}catch(t){}else i||t||(t=setInterval(function(){a(r)},250),setTimeout(function(){t&&(e=!1,n={},o(t))},6e4))}}},A=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=[];if(document&&document.cookie){var n=document.cookie.split(";");"all"===t&&(e=n),Array.isArray(t)&&n&&n.length>0&&(e=n.filter(function(e){var n=e.trim().split("=")[0];return!!t.includes(n)||0===n.indexOf("_nv_")}))}return e},C=D(),E=N(),P=new e,M=window[o].Optimize.data,R=(S={campDetails:{},goalNames:{},goalConverts:{},2:function(t,e,n,i){return new Promise(function(o,a){var r=document.querySelector(t);r&&(r.setAttribute("nvAbGoal_"+n+"_"+i,e),r.addEventListener("click",S.clickGoalHandler,!0)),o(!0)})},3:function(){return new Promise(function(t,e){t(!0)})},clickGoalHandler:function(t){var e=(t=>{var e={};if(!t.hasAttributes())return e;for(var n of t.attributes)n.name.startsWith("nvabgoal")&&(e[n.name]=n.value);return e})(t.currentTarget);if(e){var n={},i=sessionStorage.getItem("_nv_abtest_cg");i&&""!==i&&(i=JSON.parse(i),n=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?T(n,!0).forEach(function(e){O(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):T(n).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}({},n)),Object.values(e).forEach(function(t,e){var i=S.goalConverts[t],o=S.campDetails[t].varIDs;P.get("_nv_ab_goalID_"+t)||(n[i]={goalID:t,varIDs:o},S.goalConverts[i]={},S.goalConverts[i][t]=1,P.set("_nv_ab_goalID_"+t,1," ",M.cookieDomain.slice(1)),S.updateIntoGa(t),S.updateIntoNV(t))}),sessionStorage.setItem("_nv_abtest_cg",JSON.stringify(n))}},updateIntoGa:function(t){var e=S.goalNames[t],n=S.campDetails[t]&&S.campDetails[t].varIDs?S.campDetails[t].varIDs:[],i=S.goalConverts[t];i&&Array.isArray(n)&&n.length>0&&n.forEach(function(n){M.gaEvents&&Array.isArray(M.gaEvents.events)&&M.gaEvents.events.includes("ab_goal_conversion")&&C.send("NV_AB_Test","NotifyVisitors","nv_ab_goal_conversion","".concat(S.campDetails[t].nvTest,"_").concat(i,"_").concat(n,"(").concat(e,")"),!1)})},updateIntoNV:function(t){if(t){var e=S.campDetails[t].varIDs,n=S.goalConverts[t],i=S.campDetails[t].nvTest;E.get(a.urls.abtestData,{brandID:M.auth.bid,nvTest:i,goalConverts:JSON.stringify({campaignID:n,varationID:e,goalID:t}),pageUrl:window.location.href,linkReferrer:document.referrer},"nv_goalConverts",t=>{if(t&&t.goalID){var e=sessionStorage.getItem("_nv_abtest_cg");e&&""!==e?(e=JSON.parse(e),Object.keys(e).forEach(n=>{e[n].goalID===t.goalID&&delete e[n]}),sessionStorage.setItem("_nv_abtest_cg",JSON.stringify(e))):sessionStorage.removeItem("_nv_abtest_cg")}})}}},{init:function(t,e,n){var i,o,a,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};i=document,o=window,a=function(){!function(t){return!(!t||!Array.isArray(t))}(t)?console.log("invalid config obj"):t.forEach(function(t,i){if("1"!==t.type)for(var o=t.content?t.content.split(","):[],a=0;a<o.length;a++){var s=o[a];S[t.type](s,t.id,e,i),S.goalConverts[t.id]=e,S.goalNames[t.id]=t.name,S.campDetails[t.id]={},S.campDetails[t.id].varIDs=Array.isArray(n)?n:"",S.campDetails[t.id].nvTest=r.nvTest}})},"complete"==i.readyState?a():o.addEventListener?o.addEventListener("load",a,!1):o.attachEvent&&o.attachEvent("onload",a),function(t){if(t){var e=sessionStorage.getItem("_nv_abtest_cg");e&&""!==e&&(e=JSON.parse(e),Object.keys(e).length>0&&(Object.keys(e).forEach(n=>{if(n===t){var i=e[n].goalID,o=e[n].varIDs;delete e[n],S.goalConverts[t]={},S.goalConverts[t][i]=1,S.campDetails[i]={varIDs:o},S.goalConverts[i]=t,S.updateIntoGa(i),S.updateIntoNV(i)}}),sessionStorage.setItem("_nv_abtest_cg",JSON.stringify(e))))}}(e)},goalConverts:function(t){return S.goalConverts[t]}});k||(k=new class{constructor(){this.oDomain="",this._CookieController=new e,this.windowObjName=window[o].Optimize.data,this.nvGoals=R,this.loadListner=this.loadListner.bind(this),this.getAbData=this.getAbData.bind(this),this.saveData=this.saveData.bind(this),this.makeXMLRequest=this.makeXMLRequest.bind(this),this.sendUsingBeacon=this.sendUsingBeacon.bind(this),this.timeOnSite=this.timeOnSite.bind(this)}loadListner(){I=new Date,t.initialize({currentPageName:location.href,idleTimeoutInSeconds:10}),t.getTimeOnCurrentPageInSeconds()}getStartTime(){return I}getAbData(){if(this.windowObjName.abTest&&"object"==typeof this.windowObjName.abTest){var t={},e=this.windowObjName.abTest;return Object.keys(e).forEach(function(n,i){"object"==typeof e[i]&&e[i].cid&&e[i].vid&&(t[i]={vid:e[i].vid,cid:e[i].cid,device:e[i].campDetail&&e[i].campDetail.device?e[i].campDetail.device:"",userAgent_v1:e[i].campDetail&&e[i].campDetail.userAgent_v1?e[i].campDetail.userAgent_v1:""})}),t}return 0}saveData(e){j=new Date;var n=document.body,i=document.documentElement,o=n?Math.max(n.scrollHeight,n.offsetHeight,i.clientHeight,i.scrollHeight,i.offsetHeight):0,a={brandID:this.windowObjName.auth.bid,domain:e&&e.oDomain?e.oDomain:this.windowObjName.domain,path:e&&e.url?e.url.pathname:location.pathname,hash:e&&e.url?e.url.hash:location.hash,routingType:e&&e.routeType?e.routeType:notify_visitors.routingType?notify_visitors.routingType:"",activeTime:Math.abs(t.getTimeOnCurrentPageInSeconds()).toFixed(3),timeOnPage:Math.abs((j-I)/1e3).toFixed(3),pageheight:e&&e.height?e.height:o,pagewidth:document.body.clientWidth,resolution:window.screen.width+"x"+window.screen.height,linkReferrer:document.referrer,pageUrl:e&&e.url?e.url.href:window.location.href,abTest:this.getAbData()};window.navigator.sendBeacon?this.sendUsingBeacon(a):this.makeXMLRequest(a)}makeXMLRequest(t){var e=new XMLHttpRequest;e.onreadystatechange=function(t){},e.open("POST",a.urls.heatmapData,!1),e.setRequestHeader("Content-Type","text/plain"),e.send(JSON.stringify(t)),console.log("xml request")}sendUsingBeacon(t){var e=a.urls.heatmapData;t&&t.brandID&&"7342"==t.brandID&&(e=a.urls.heatmapData_new),window.navigator.sendBeacon(e,JSON.stringify(t))}timeOnSite(){window.addEventListener("unload",function(t,e){var n=new Date,i=Math.abs(n-e),o=t._CookieController.get("_nv_ttsOnpage_"+t.windowObjName.auth.bid);o="string"==typeof o&&o.length>0?g(JSON.parse(o)):0;var a=new Date;a.setTime(a.getTime()+2592e6);var r=a.toUTCString();t._CookieController.set("_nv_ttsOnpage_"+t.windowObjName.auth.bid,JSON.stringify(m(o+i)),r)}.bind(null,this,I),!1)}});var U=k,x={},J=D(),L=N(),V=function(){var t=window[o].Optimize.data,e=t.gaEvents&&t.gaEvents.trackingID?t.gaEvents.trackingID:"";function n(t){for(var e=[/\@\{(.+?)\}\@/g,/\@\[(.+?)\]\@/g,/\[\[(.+?)\]\]/g],n=0;n<e.length;n++)if(t.match(e[n]))return null;return t}return{init:function(i){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};J.create("NV_AB_Test",e),i.forEach(function(e){if(t.gaEvents&&Array.isArray(t.gaEvents.events)&&t.gaEvents.events.includes("ab_variation_applied")&&J.send("NV_AB_Test","NotifyVisitors","nv_ab_variation_applied","".concat(o.nvTest,"_").concat(o.campaignID,"_").concat(e.variationID),!0),e.variationID&&o&&o.campaignID){var i={cid:o.campaignID,vid:e.variationID};o.visitorData&&(i.vd=o.visitorData),L.get(a.urls.abtestData,{brandID:t.auth.bid,nvTest:o.nvTest,pageViews:JSON.stringify(i),pageUrl:window.location.href,linkReferrer:document.referrer},"nv_pageViews",()=>{})}if(e.content){x[e.variationID]=!0;var r=JSON.parse(e.content);if(r&&"object"==typeof r){var s=Object.assign({},r);setTimeout(function(){x[e.variationID]=!1},6e4),function t(e,i){Object.keys(e).forEach(function(t){var i,o,a=document.querySelector(t);a&&(i=t,(o=e[t])&&"object"==typeof o&&Object.keys(o).forEach(function(t){var e,a=document.querySelector(i);if(a){if("styleChange"===t){var r=o[t].changes?o[t].changes:o[t];Object.keys(r).forEach(function(t){var e=void 0!==a.style[t]?n(r[t]):"";if(e){a.style[t]=e;var i=_(a,t,e);i&&a.setAttribute("style",i)}}),o[t].changes&&Object.keys(o[t].changes).forEach(e=>{var i=!1,r=void 0!==e?e.split("_"):"";2===r.length&&(r[1]=Number(r[1]),i="a"===r[0]?window.innerWidth>=r[1]:!!r[1]&&window.innerWidth<=r[1]),i&&Object.keys(o[t].changes[e]).forEach(function(i){var r=void 0!==a.style[i]?n(o[t].changes[e][i]):"";if(r){a.style[i]=r;var s=_(a,i,r);s&&a.setAttribute("style",s)}})})}if("textChange"===t){var s=n(o[t]);s&&(a.innerText=s)}if("imageChange"===t&&Object.keys(o[t]).forEach(function(e){var i=n(o[t][e]);i&&a.setAttribute(e,i)}),"changePosition"===t&&(o[t].resoChanges?(a.style.transform=o[t].resoChanges.normal?o[t].resoChanges.normal:o[t].changes,Object.keys(o[t].resoChanges).forEach(e=>{var n=!1,i=void 0!==e?e.split("_"):"";2===i.length&&(i[1]=Number(i[1]),n="a"===i[0]?window.innerWidth>=i[1]:!!i[1]&&window.innerWidth<=i[1]),n&&(a.style.transform=o[t].resoChanges[e])})):a.style.transform=o[t].changes),"displayChanges"===t){var c=Object.keys(o[t])[0];a.setAttribute(c,o[t][c]),a.style.visibility="hidden"}if("pasteElement"===t){var u=o[t];if(u&&"object"==typeof u&&u.insertType&&u.insertType.includes("Insert")){var f=u.insertType.split("::")[1];f&&u.newTargetEl&&("Before"===f?a.parentNode.insertBefore(d(u.newTargetEl),a):"After"===f&&a.parentNode.insertBefore(d(u.newTargetEl),a.nextSibling))}}if("textNodeChange"===t&&Object.keys(o[t]).forEach(function(e){var n=parseInt(e);Array.prototype.forEach.call(a.childNodes,function(e,i){i===n&&(e.nodeValue=o[t][n])})}),"linkChange"===t){var s=n(o[t]);s&&a.setAttribute("href",s)}if("sortable"===t&&(v(a),l(a,o[t])),"reArrange"===t&&h(o[t].old,o[t].new),"HTMLChanges"===t){var s=n(o[t].trim());s&&(a.parentNode.insertBefore(y(s).cloneNode(!0),a.nextSibling),a.parentNode.removeChild(a))}if("addHTMLBefore"===t){var s=n(o[t].trim());if(s){var w=y(s,!0),m=Object.values(w.childNodes);m.forEach(function(t,e){a.parentNode.insertBefore(t,a)})}}if("addHTMLAfter"===t){var s=n(o[t].trim());if(s){var w=y(s,!0),m=Object.values(w.childNodes);m.forEach(function(t,e){a.parentNode.insertBefore(t,a.nextSibling)})}}if("addScript"===t){var s=n(o[t].jsCode);s&&(e=a,new Function("element",s)(e))}}}),delete e[t])}),Object.keys(e).length>0&&x[i]?setTimeout(()=>{t(e,i)},100):x[i]=!1}(s,e.variationID)}}})}}}(),H=function(){var t=window[o].Optimize.data,e=window[o].ab_overlay,n=null,i={};function r(){n&&window.clearInterval(n);var e=document.createElement("a");document.body.appendChild(e),e.setAttribute("type","hidden"),e.setAttribute("rel","nofollow"),e.href=function(e){e=(e=(n=e,i=new URL(window.location),n=new URL(n),i.searchParams.forEach((t,e)=>{n.searchParams.has(e)||n.searchParams.append(e,t)}),n).href).split("?").length<=1?e+"?_s_cid="+t.abTest[t.abTest.split].cid+"&_s_vid="+t.abTest[t.abTest.split].vid:e+"&_s_cid="+t.abTest[t.abTest.split].cid+"&_s_vid="+t.abTest[t.abTest.split].vid;var n,i;t.abTest[t.abTest.split].visitorData&&t.abTest[t.abTest.split].visitorData.visitorsCount&&(e=e+"&_s_vd="+t.abTest[t.abTest.split].visitorData.visitorsCount);return e}(i.variation.content),e.click(),t.isIE?e.parentNode.removeChild(e):e.remove()}return{init:function(o){var s,d,u,f;if((i=o).campDetail.status)if(i.variation&&i.variation.content)e&&(s="_nv_hm_hidden_element_split",d=document.createElement("style"),u="body{opacity:0 !important;filter:alpha(opacity=0) !important;background:none !important;}",f=document.getElementsByTagName("head")[0],d.setAttribute("id",s),d.setAttribute("type","text/css"),d.styleSheet?d.styleSheet.cssText=u:d.appendChild(document.createTextNode(u)),f&&f.appendChild(d),setTimeout(function(){b(s)},1e4)),document.body?r():n=window.setInterval(()=>{document.body&&r()},100);else if("1"==i.variation.variationID&&""==i.variation.content){var v=t.abTest[t.abTest.split];if(v&&v.cid&&v.variation&&v.variation.variationID){var l={cid:v.cid,vid:v.variation.variationID};v.visitorData&&(l.vd=v.visitorData),N().get(a.urls.abtestData,{brandID:t.auth.bid,nvTest:c("1"),pageViews:JSON.stringify(l),pageUrl:window.location.href,linkReferrer:document.referrer},"nv_pageViews",()=>{})}}}}}();class B{constructor(){this.document=window.document,this.browserStatus={isSafari:0,isChrome:0,isFirefox:0,isIE:0,isSafariPush:0,isChromePush:0,isFirefoxPush:0,isEdgePush:0},this.isIncognito=0}getMobileStatus(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?1:0}getBrowser(){var t,e=window.navigator.userAgent;if(document.documentMode||/Edge/.test(e)||/EdgA/.test(e)||/Edg/.test(e))this.browserStatus.isIE=1,t=/Edge/.test(e)||/EdgA/.test(e)?e.substring(e.indexOf("Edg")+5).split(".")[0]:e.substring(e.indexOf("Edg")+4).split(".")[0],this.browserStatus.isEdgePush=t>=17?1:0;else if(/chrome/i.test(e))this.browserStatus.isChrome=1,t=/Android|webOS/i.test(navigator.userAgent)?e.split("/")[e.split("/").length-2]:e.split(" ")[e.split(" ").length-2].substr(7),this.browserStatus.isChromePush=t.split(".")[0]>=42?1:0;else if(e.indexOf("Safari")>0&&-1==e.indexOf("Chrome"))this.browserStatus.isSafari=1,t=e.substring(0,e.indexOf("Safari")).substring(e.substring(0,e.indexOf("Safari")).lastIndexOf("/")+1),this.browserStatus.isSafariPush=parseInt(t,10)>=7?1:0;else if(/firefox/i.test(e)){this.browserStatus.isFirefox=1;var n=e.indexOf("Firefox"),i=e.substring(n+8),o=parseInt(""+i,10);o=isNaN(o)?parseInt(navigator.appVersion,10):o,this.browserStatus.isFirefoxPush=o>=44&&!/Android|webOS/i.test(navigator.userAgent)||o>=48&&/Android|webOS/i.test(navigator.userAgent)?1:0}return this.browserStatus}checkIncognito(){return new Promise((t,e)=>{this.isIncognito=0;var n=this,i=window.navigator.userAgent;if(document.documentMode||/Edge/.test(i))window.indexedDB||!window.PointerEvent&&!window.MSPointerEvent?t(!1):(n.isIncognito=1,t(!0));else if(/chrome/i.test(i)){var o=window.RequestFileSystem||window.webkitRequestFileSystem;o?o(window.TEMPORARY,100,()=>t(!1),()=>{n.isIncognito=1,t(!0)}):(n.isIncognito=1,t(!0))}else if(/firefox/i.test(i)){if(window.indexedDB&&/Firefox/.test(window.navigator.userAgent)){var a,r;try{(a=window.indexedDB.open("test")).onerror=function(){return!0}}catch(e){r=!0,n.isIncognito=1,t(!0)}void 0===r&&function(t,e){var n=0,i=!1,o=window.setInterval(function(){t()&&(window.clearInterval(o),e(i)),n++>50&&(window.clearInterval(o),e(i=!0))},10)}(function(){return"done"===a.readyState},function(e){e||(!0===(r=!a.result)?(n.isIncognito=1,t(!0)):t(!1))})}}else if(/Safari/.test(i)){var s;try{window.openDatabase(null,null,null,null)}catch(e){"QuotaExceededError"===e.name?n.isIncognito=0:n.isIncognito=1,s=!0,t(!0)}void 0===s&&(s=!1,n.isIncognito=0,t(!1))}setTimeout(function(){t(!1)},1e3)})}getQueryValue(t){for(var e=window.location.search.substring(1).split("&"),n=0;n<e.length;n++){var i=e[n].split("=");if(i[0]==t)return i[1]}}}var F=document.body,G=document.documentElement,W={},q={};class z{constructor(t,n){this._resData=t,this._windowObj=n[o].Optimize.data,this._nvAbTest=V,this._nvGoals=R,this._nvSplitUrl=H,this._getdata=U,this._getJSONP=N(),this.handleResponse=this.handleResponse.bind(this),this.handledatatosend=this.handledatatosend.bind(this),this.bodyloadHandler=this.bodyloadHandler.bind(this),this.reinitalizeGoal=this.reinitalizeGoal.bind(this),this._CookieController=new e,this._BrowserController=new B}handleResponse(){if("fail"==this._resData.Authentication)return!1;this._BrowserController.getBrowser(),window[o].Optimize.data&&(window[o].Optimize.data.details=this._BrowserController.browserStatus),this._getdata.loadListner(),this._getdata.timeOnSite(),this._windowObj.cookie_path=window.location.pathname;var t=p(this._resData);if(t.abTest||t.split||t.abTestGoals){W.thispage=Object.assign({},window.location),window.addEventListener("unload",this._getdata.saveData,!1),W.oDomain=this._getdata.windowObjName.domain,W.routeType=notify_visitors.routingType?notify_visitors.routingType:"",W.nv_auth=notify_visitors.auth,F=document.body,G=document.documentElement;var e=F?Math.max(F.scrollHeight,F.offsetHeight):0,n=G?Math.max(G.clientHeight,G.scrollHeight,G.offsetHeight):0;W.height=e||n?Math.max(n,e):0}if(t.split){var i=!0;window[o].ab_overlay&&(i=!!document.querySelector("#_nv_hm_hidden_element"));var r=this._resData.abTest.split,s=this._resData.abTest[r];if(i){if(s.campDetail.hasOwnProperty("splitRedirection")){this._windowObj.abTest[r].cid=w("_s_cid"),this._windowObj.abTest[r].vid=[w("_s_vid")];var d=w("_s_vd");if(d&&(this._windowObj.abTest[r].vd=d),this._windowObj.abTest[r].c_e_ts=s.campDetail.e_ts,this._windowObj.abTest[r]&&"object"==typeof this._windowObj.abTest[r]){var u=this._windowObj.abTest[r];if(u&&u.cid&&u.vid&&u.vid[0]){var f={cid:u.cid,vid:u.vid[0]};u.visitorData&&u.vd&&(f.vd=u.visitorData),this._getJSONP.get(a.urls.abtestData,{brandID:this._windowObj.auth.bid,nvTest:c("1"),pageViews:JSON.stringify(f),pageUrl:window.location.href,linkReferrer:document.referrer},"nv_pageViews",()=>{})}}}else s.hasOwnProperty("variation")&&Array.isArray(s.variation)&&s.variation.length>0&&(this._windowObj.abTest[r].cid=s.campDetail.campaignID,this._windowObj.abTest[r].vid=s.campDetail.variationIDs,s.variation=s.variation[0],this._nvSplitUrl.init(s));if(s.hasOwnProperty("goals")&&s.goals&&"object"==typeof s.goals){var v={campaignID:this._windowObj.abTest[r].campDetail.campaignID?this._windowObj.abTest[r].campDetail.campaignID:"",nvTest:this._windowObj.abTest[r].campDetail.type?c(this._windowObj.abTest[r].campDetail.type):""};this._nvGoals.init(s.goals,this._windowObj.abTest[r].cid,this._windowObj.abTest[r].vid,v)}}}var l=this;if(t.abTest){var h=this._resData.abTest;Object.keys(this._resData.abTest).forEach(function(t,e){"object"==typeof h[t]&&l.abTest(h[t],e)})}if(t.abTestGoals){var m=this._resData.abTestGoals;Object.keys(this._resData.abTestGoals).forEach(function(t,e){"object"==typeof m[t]&&l.abTestGoals(m[t],e)})}setTimeout(function(){b()},200)}abTest(t,e){var n,i=(t.campDetail?t.campDetail.e_ts:0)||0;i=1e3*i>=(new Date).getTime()?1e3*i:(new Date).getTime()+864e5;var a=this._CookieController.get("_nv_ab_app_"+this._windowObj.auth.bid+"_"+t.campDetail.campaignID)||0;n="0"==t.campDetail.type;var r=window[o].ab_overlay,d=!!s("nv_preview",document.location.href),u=!!document.querySelector("#_nv_hm_hidden_element");if(n&&r&&(1==a||u)||n&&!r||d||!n){var f=t;if(f.hasOwnProperty("variation")&&f.variation&&Array.isArray(f.variation)){this._CookieController.set("_nv_ab_app_"+this._windowObj.auth.bid+"_"+f.campDetail.campaignID,"1",new Date(i).toGMTString()),this._windowObj.abTest[e].cid=f.campDetail.campaignID,this._windowObj.abTest[e].vid=f.campDetail.variationIDs,this._windowObj.abTest[e].c_e_ts=f.campDetail.e_ts;var v={campaignID:f.campDetail&&f.campDetail.campaignID?t.campDetail.campaignID:"",nvTest:f.campDetail&&t.campDetail.type?c(t.campDetail.type):""};if(f.visitorData&&(v.visitorData=f.visitorData),document.body)this._nvAbTest.init(t.variation,v);else{var l=f.campDetail.campaignID+"_"+f.campDetail.variationIDs;q[l]=window.setInterval(function(){this.bodyloadHandler(t.variation,l,v)}.bind(this),100)}}f.hasOwnProperty("goals")&&f.goals&&"object"==typeof f.goals&&this._nvGoals.init(f.goals,this._windowObj.abTest[e].cid,this._windowObj.abTest[e].vid,v)}}abTestGoals(t,e){var n=t,i={campaignID:t.cid?t.cid:"",nvTest:c("0")};n.hasOwnProperty("goals")&&n.goals&&"object"==typeof n.goals&&this._nvGoals.init(n.goals,this._windowObj.abTestGoals[e].cid,this._windowObj.abTestGoals[e].vid,i)}handledatatosend(){var t={url:W.thispage,height:W.height,oDomain:W.oDomain,routeType:W.routeType};U.saveData(t)}bodyloadHandler(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";document.body&&(q[e]&&(q[e]=clearInterval(q[e])),this._nvAbTest.init(t,n))}reinitalizeGoal(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";t&&"object"==typeof t&&e&&n&&this._nvGoals.init(t,e,n,i)}}var Q=new z(window[o].Optimize.data,window);return Q.handleResponse(),z.reinitalizeGoal=Q.reinitalizeGoal,z}();
